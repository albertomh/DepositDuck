# Re-usable steps for a GitHub Action that ...
#
# Usage:
#   ```
#   steps:
#     - uses: ./.github/actions/test
#   ```
#
# (c) 2024 Alberto Morón Hernández
name: 'test'
description: 'Run unit and integration tests'

runs:
  using: 'composite'
  steps:
    - uses: ./.github/actions/uv
    # must run in its own step because environment variables are
    # only available in steps after the one that sets them.
    - run: ./local/read_dotenv.sh .env.test
      shell: bash
    - run: |
        make install-deps-test
        make test
      shell: bash
